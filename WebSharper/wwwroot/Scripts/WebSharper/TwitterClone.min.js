(function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M;b=a.WebSharper=a.WebSharper||{};c=b.Client=b.Client||{};d=b.TweetPushProcess=b.TweetPushProcess||{};e=b.Templating=b.Templating||{};f=a.TwitterClone_Templates=a.TwitterClone_Templates||{};g=a.TwitterClone_JsonEncoder=a.TwitterClone_JsonEncoder||{};h=a.TwitterClone_JsonDecoder=a.TwitterClone_JsonDecoder||{};i=b&&b.Strings;j=a.IntelliFactory;k=j&&j.Runtime;l=b&&b.Utils;m=a.console;n=b&&b.Concurrency;o=b&&b.Remoting;p=o&&o.AjaxRemotingProvider;q=a.JSON;r=b&&b.Arrays;s=b&&b.UI;t=s&&s.Var$1;u=b&&b.JavaScript;v=u&&u.Promise;w=b&&b.AspNetCore;x=w&&w.WebSocket;y=x&&x.Client;z=y&&y.WithEncoding;A=s&&s.Templating;B=A&&A.Runtime;C=B&&B.Server;D=C&&C.ProviderBuilder;E=C&&C.Handler;F=C&&C.TemplateInstance;G=b&&b.List;H=s&&s.Doc;I=s&&s.AttrProxy;J=s&&s.Client;K=J&&J.Templates;L=b&&b.ClientSideJson;M=L&&L.Provider;c.Twitter$269$23=function(N,O){return function(P){var Q,R,S,T,U;Q=P.Vars.Hole("tweetid").$1.Get();R="\""+i.Join("\",\"",i.SplitChars(P.Vars.Hole("retweettags").$1.Get(),[","],0))+"\"";S="\""+i.Join("\",\"",i.SplitChars(P.Vars.Hole("retweetmentions").$1.Get(),[","],0))+"\"";T=((((k.Curried(function(V,W,X,Y){return V("{\"tweetId\": \""+l.toSafe(W)+"\", \"tag\": ["+l.toSafe(X)+"], \"mention\": ["+l.toSafe(Y)+"]}");},4))(a.id))(Q))(R))(S);m.log(T);n.StartImmediate((U=null,n.Delay(function(){return n.Bind((new p.New()).Async("TwitterClone:WebSharper.Server.DoReTweet:-1915423140",[T]),function(V){var W,X;N.Set(V);self.location.reload();X=q.parse(V);if(X.status==="success"){try{W=X.content;}catch(Y){W=[];}O.$0.Post({$:0,$0:r.get(W,0).userId,$1:r.get(W,0).tweetId});return n.Zero();}else return n.Zero();});})),null);};};c.Twitter$247$21=function(N,O){return function(P){var Q,R,S,T,U;Q=P.Vars.Hole("tweetcontent").$1.Get();R="\""+i.Join("\",\"",i.SplitChars(P.Vars.Hole("tweettags").$1.Get(),[","],0))+"\"";S="\""+i.Join("\",\"",i.SplitChars(P.Vars.Hole("tweetmentions").$1.Get(),[","],0))+"\"";T=((((k.Curried(function(V,W,X,Y){return V("{\"content\": \""+l.toSafe(W)+"\", \"tag\": ["+l.toSafe(X)+"], \"mention\": ["+l.toSafe(Y)+"]}");},4))(a.id))(Q))(R))(S);m.log(T);n.StartImmediate((U=null,n.Delay(function(){return n.Bind((new p.New()).Async("TwitterClone:WebSharper.Server.DoTweet:-1915423140",[T]),function(V){var W,X;N.Set(V);self.location.reload();X=q.parse(V);if(X.status==="success"){try{W=X.content;}catch(Y){W=[];}O.$0.Post({$:0,$0:r.get(W,0).userId,$1:r.get(W,0).tweetId});return n.Zero();}else return n.Zero();});})),null);};};c.Twitter=function(N){var O,P,Q,R,S,T,U,V;O=t.Create$1("");P=null;v.OfAsync((Q=null,n.Delay(function(){return z.ConnectStateful(function(W){return q.stringify((g.j())(W));},function(W){return(h.j())(q.parse(W));},N,function(){var W;W=null;return n.Delay(function(){return n.Return([0,function(X){return function(Y){var Z;Z=null;return n.Delay(function(){var _0,_1,_2,_3,_4,_5,_6;if(Y.$==0){_6=Y.$0.$0;m.log(_6);try{_3=q.parse(_6).content;}catch(_7){_3=[];}_2=(_4=self.document.getElementById("tweetsDemoPanel"),_5=self.document.createElement("div"),_5.setAttribute("class","card"),_5.innerHTML=function(_8){return _8("<div class=\"card\">\r\n                                                    <div class=\"card-body\">\r\n                                                        <h5 class=\"card-title\">"+a.String(r.get(_3,0).userId)+"</h5>\r\n                                                        <p class=\"card-text\">"+a.String(r.get(_3,0).text)+"</p>\r\n                                                        <ul class=\"list-group list-group-flush\">\r\n                                                          <li class=\"list-group-item fs-6 fw-light\">tweetId: "+a.String(r.get(_3,0).tweetId)+"</li>\r\n                                                          <li class=\"list-group-item fs-6 fw-light\">Time: "+a.String(r.get(_3,0).timestamp)+"</li>\r\n                                                        </ul>\r\n                                                    </div>\r\n                                                </div>");}(a.id),_4.prepend.apply(_4,[_5]),n.Zero());return n.Combine(_2,n.Delay(function(){return n.Return(X+1);}));}else return Y.$==3?(m.log("WebSocket Connection Close"),n.Return(X)):Y.$==1?(m.log("WebSocket Connection Error"),n.Return(X)):(m.log("WebSocket Connection Open"),n.Return(X));});};}]);});});}))).then(function(W){P={$:1,$0:W};});return(R=(S=(T=new D.New$1(),(T.h.push(E.EventQ2(T.k,"ontweet",function(){return T.i;},function(W){var X,Y,Z,_0,_1;X=W.Vars.Hole("tweetcontent").$1.Get();Y="\""+i.Join("\",\"",i.SplitChars(W.Vars.Hole("tweettags").$1.Get(),[","],0))+"\"";Z="\""+i.Join("\",\"",i.SplitChars(W.Vars.Hole("tweetmentions").$1.Get(),[","],0))+"\"";_0=((((k.Curried(function(_2,_3,_4,_5){return _2("{\"content\": \""+l.toSafe(_3)+"\", \"tag\": ["+l.toSafe(_4)+"], \"mention\": ["+l.toSafe(_5)+"]}");},4))(a.id))(X))(Y))(Z);m.log(_0);n.StartImmediate((_1=null,n.Delay(function(){return n.Bind((new p.New()).Async("TwitterClone:WebSharper.Server.DoTweet:-1915423140",[_0]),function(_2){var _3,_4;O.Set(_2);self.location.reload();_4=q.parse(_2);if(_4.status==="success"){try{_3=_4.content;}catch(_5){_3=[];}P.$0.Post({$:0,$0:r.get(_3,0).userId,$1:r.get(_3,0).tweetId});return n.Zero();}else return n.Zero();});})),null);})),T)),(S.h.push(E.EventQ2(S.k,"onretweet",function(){return S.i;},function(W){var X,Y,Z,_0,_1;X=W.Vars.Hole("tweetid").$1.Get();Y="\""+i.Join("\",\"",i.SplitChars(W.Vars.Hole("retweettags").$1.Get(),[","],0))+"\"";Z="\""+i.Join("\",\"",i.SplitChars(W.Vars.Hole("retweetmentions").$1.Get(),[","],0))+"\"";_0=((((k.Curried(function(_2,_3,_4,_5){return _2("{\"tweetId\": \""+l.toSafe(_3)+"\", \"tag\": ["+l.toSafe(_4)+"], \"mention\": ["+l.toSafe(_5)+"]}");},4))(a.id))(X))(Y))(Z);m.log(_0);n.StartImmediate((_1=null,n.Delay(function(){return n.Bind((new p.New()).Async("TwitterClone:WebSharper.Server.DoReTweet:-1915423140",[_0]),function(_2){var _3,_4;O.Set(_2);self.location.reload();_4=q.parse(_2);if(_4.status==="success"){try{_3=_4.content;}catch(_5){_3=[];}P.$0.Post({$:0,$0:r.get(_3,0).userId,$1:r.get(_3,0).tweetId});return n.Zero();}else return n.Zero();});})),null);})),S)),(U=E.CompleteHoles(R.k,R.h,[["tweetcontent",0],["tweettags",0],["tweetmentions",0],["tweetid",0],["retweettags",0],["retweetmentions",0]]),(V=new F.New(U[1],f.twitterform(U[0])),R.i=V,V))).get_Doc();};c.Account$175$24=function(){return function(N){var O,P;O=N.Vars.Hole("unfollowid").$1.Get();m.log(O);n.StartImmediate((P=null,n.Delay(function(){return n.Bind((new p.New()).Async("TwitterClone:WebSharper.Server.DoUnfollow:-1915423140",[O]),function(Q){m.log(Q);self.location.reload();return n.Zero();});})),null);};};c.Account$164$22=function(){return function(N){var O,P;O=N.Vars.Hole("followid").$1.Get();m.log(O);n.StartImmediate((P=null,n.Delay(function(){return n.Bind((new p.New()).Async("TwitterClone:WebSharper.Server.DoFollow:-1915423140",[O]),function(Q){m.log(Q);self.location.reload();return n.Zero();});})),null);};};c.Account=function(){var N,O,P,Q,R;t.Create$1("");return(N=(O=(P=new D.New$1(),(P.h.push(E.EventQ2(P.k,"onfollow",function(){return P.i;},function(S){var T,U;T=S.Vars.Hole("followid").$1.Get();m.log(T);n.StartImmediate((U=null,n.Delay(function(){return n.Bind((new p.New()).Async("TwitterClone:WebSharper.Server.DoFollow:-1915423140",[T]),function(V){m.log(V);self.location.reload();return n.Zero();});})),null);})),P)),(O.h.push(E.EventQ2(O.k,"onunfollow",function(){return O.i;},function(S){var T,U;T=S.Vars.Hole("unfollowid").$1.Get();m.log(T);n.StartImmediate((U=null,n.Delay(function(){return n.Bind((new p.New()).Async("TwitterClone:WebSharper.Server.DoUnfollow:-1915423140",[T]),function(V){m.log(V);self.location.reload();return n.Zero();});})),null);})),O)),(Q=E.CompleteHoles(N.k,N.h,[["followid",0],["unfollowid",0]]),(R=new F.New(Q[1],f.accountform(Q[0])),N.i=R,R))).get_Doc();};c.FollowList=function(N){return G.map(function(O){return H.Element("div",[],[H.Element("a",[I.Create("class","list-group-item")],[H.TextNode(O)])]);},(new p.New()).Sync("TwitterClone:WebSharper.Server.getFollowersList:-1216520703",[N]));};c.Register$130$24=function(){return function(N){var O,P,Q,R,S;O=N.Vars.Hole("registerusername").$1.Get();P=N.Vars.Hole("registeruserpass").$1.Get();Q=N.Vars.Hole("registeruseremail").$1.Get();R=(((k.Curried3(function(T,U,V){return T("{\"email\": \""+l.toSafe(U)+"\", \"nickName\": \""+l.toSafe(V)+"\"}");}))(a.id))(Q))(O);m.log(O+" : "+P+" : "+Q);n.StartImmediate((S=null,n.Delay(function(){return n.Bind((new p.New()).Async("TwitterClone:WebSharper.Server.DoRegister:-1512493584",[O,P,R]),function(T){return q.parse(T).status==="success"?(self.location.replace("/"),n.Zero()):n.Zero();});})),null);};};c.Register=function(){var N,O,P,Q;t.Create$1("");return(N=(O=new D.New$1(),(O.h.push(E.EventQ2(O.k,"onregister",function(){return O.i;},function(R){var S,T,U,V,W;S=R.Vars.Hole("registerusername").$1.Get();T=R.Vars.Hole("registeruserpass").$1.Get();U=R.Vars.Hole("registeruseremail").$1.Get();V=(((k.Curried3(function(X,Y,Z){return X("{\"email\": \""+l.toSafe(Y)+"\", \"nickName\": \""+l.toSafe(Z)+"\"}");}))(a.id))(U))(S);m.log(S+" : "+T+" : "+U);n.StartImmediate((W=null,n.Delay(function(){return n.Bind((new p.New()).Async("TwitterClone:WebSharper.Server.DoRegister:-1512493584",[S,T,V]),function(X){return q.parse(X).status==="success"?(self.location.replace("/"),n.Zero()):n.Zero();});})),null);})),O)),(P=E.CompleteHoles(N.k,N.h,[["registerusername",0],["registeruseremail",0],["registeruserpass",0]]),(Q=new F.New(P[1],f.loginblock(P[0])),N.i=Q,Q))).get_Doc();};c.Login$110$21=function(){return function(N){var O,P,Q;O=N.Vars.Hole("inputusername").$1.Get();P=N.Vars.Hole("inputuserpass").$1.Get();m.log(O+" : "+P);n.StartImmediate((Q=null,n.Delay(function(){return n.Bind((new p.New()).Async("TwitterClone:WebSharper.Server.DoLogin:1719588972",[O,P]),function(R){var S;S=q.parse(R).status;m.log(S);return S==="success"?(self.location.replace("/"),n.Zero()):n.Zero();});})),null);};};c.Login=function(){var N,O,P,Q;return(N=(O=new D.New$1(),(O.h.push(E.EventQ2(O.k,"onlogin",function(){return O.i;},function(R){var S,T,U;S=R.Vars.Hole("inputusername").$1.Get();T=R.Vars.Hole("inputuserpass").$1.Get();m.log(S+" : "+T);n.StartImmediate((U=null,n.Delay(function(){return n.Bind((new p.New()).Async("TwitterClone:WebSharper.Server.DoLogin:1719588972",[S,T]),function(V){var W;W=q.parse(V).status;m.log(W);return W==="success"?(self.location.replace("/"),n.Zero()):n.Zero();});})),null);})),O)),(P=E.CompleteHoles(N.k,N.h,[["inputusername",0],["inputuserpass",0]]),(Q=new F.New(P[1],f.loginblock$1(P[0])),N.i=Q,Q))).get_Doc();};c.Test=function(){var N,O;N=H.Input([],t.Create$1(""));O=H.Element("div",[I.Create("class","panel-default")],[H.Element("div",[I.Create("class","panel-body")],[N])]);K.LoadLocalTemplates("");H.RunById("main",O);};c.Db$76$22=function(){return function(){var N;n.StartImmediate((N=null,n.Delay(function(){(new p.New()).Send("TwitterClone:WebSharper.Server.DoDBInit:6",[]);return n.Zero();})),null);};};c.Db=function(){var N,O,P,Q,R;return(N=(O=(P=new D.New$1(),(P.h.push(E.EventQ2(P.k,"oninitdb",function(){return P.i;},function(){var S;n.StartImmediate((S=null,n.Delay(function(){(new p.New()).Send("TwitterClone:WebSharper.Server.DoDBInit:6",[]);return n.Zero();})),null);})),P)),(O.h.push({$:1,$0:"result",$1:"Sccess!"}),O)),(Q=E.CompleteHoles(N.k,N.h,[["texttoreverse",0]]),(R=new F.New(Q[1],f.mainform(Q[0])),N.i=R,R))).get_Doc();};c.guest$44$26=k.Curried3(function(N,O,P){var Q;return n.Start((Q=null,n.Delay(function(){m.log("login");self.location.replace("/welcome");return n.Return(null);})),null);});c.guest=function(){return H.Element("div",[I.Create("style","margin-bottom: 20px")],[H.Element("p",[I.Create("style","display: inline; margin: 0 10px 15px 0")],[H.TextNode("click here to log in:")]),H.Element("button",[I.Create("class","btn btn-primary mybtn"),I.HandlerImpl("click",function(){return function(){var N;return n.Start((N=null,n.Delay(function(){m.log("login");self.location.replace("/welcome");return n.Return(null);})),null);};})],[H.TextNode("login")])]);};c.LoggedInUser$29$26=k.Curried3(function(N,O,P){var Q;return n.Start((Q=null,n.Delay(function(){return n.Bind((new p.New()).Async("TwitterClone:WebSharper.Server.DoLogout:-741060419",[]),function(){self.location.replace("/");return n.Return(null);});})),null);});c.LoggedInUser=function(){return H.Element("div",[I.Create("style","margin-bottom: 20px")],[H.Element("p",[I.Create("style","display: inline; margin: 0 10px 15px 0")],[H.TextNode("click here to log out:")]),H.Element("button",[I.Create("class","btn btn-primary mybtn"),I.HandlerImpl("click",function(){return function(){var N;return n.Start((N=null,n.Delay(function(){return n.Bind((new p.New()).Async("TwitterClone:WebSharper.Server.DoLogout:-741060419",[]),function(){self.location.replace("/");return n.Return(null);});})),null);};})],[H.TextNode("logout")])]);};d.ProcessBinding=function(N){var O,P;O=null;v.OfAsync((P=null,n.Delay(function(){return z.ConnectStateful(function(Q){return q.stringify((g.j())(Q));},function(Q){return(h.j())(q.parse(Q));},N,function(){var Q;Q=null;return n.Delay(function(){return n.Return([0,function(R){return function(S){var T;T=null;return n.Delay(function(){var U,V,W,X;return S.$==0?n.Combine((U=S.$0.$0,(m.log(U),V=q.parse(U),W=self.document.getElementById("tweetsDemoPanel"),X=self.document.createElement("li"),X.appendChild(self.document.createTextNode(V.text)),X.setAttribute("class","list-group-item"),W.appendChild(X),n.Zero())),n.Delay(function(){return n.Return(R+1);})):S.$==3?(m.log("WebSocket Connection Close"),n.Return(R)):S.$==1?(m.log("WebSocket Connection Error"),n.Return(R)):(m.log("WebSocket Connection Open"),n.Return(R));});};}]);});});}))).then(function(Q){O={$:1,$0:Q};});};e.Twitter2$102$28=function(){return function(N){var O,P;O=N.Vars.Hole("mentionsearch").$1.Get();P=(new p.New()).Sync("TwitterClone:WebSharper.Server.getTweetsListString:-1876397925",["mention",O]);self.document.getElementById("TwitterList4").innerHTML=P;};};e.Twitter2$93$24=function(){return function(N){var O,P;O=N.Vars.Hole("tabsearch").$1.Get();P=(new p.New()).Sync("TwitterClone:WebSharper.Server.getTweetsListString:-1876397925",["tag",O]);self.document.getElementById("TwitterList3").innerHTML=P;};};f.twitterform=function(N){K.LoadLocalTemplates("twitter");return N?K.NamedTemplate("twitter",{$:1,$0:"twitterform"},N):void 0;};f.accountform=function(N){K.LoadLocalTemplates("account");return N?K.NamedTemplate("account",{$:1,$0:"accountform"},N):void 0;};f.loginblock=function(N){K.LoadLocalTemplates("register");return N?K.NamedTemplate("register",{$:1,$0:"loginblock"},N):void 0;};f.loginblock$1=function(N){K.LoadLocalTemplates("login");return N?K.NamedTemplate("login",{$:1,$0:"loginblock"},N):void 0;};f.mainform=function(N){K.LoadLocalTemplates("main");return N?K.NamedTemplate("main",{$:1,$0:"mainform"},N):void 0;};g.j=function(){return g._v?g._v:g._v=(M.EncodeUnion(void 0,{tweetId:0},[["Info",[["$0","userId",M.Id(),0],["$1","tweetId",M.Id(),0]]]]))();};h.j=function(){return h._v?h._v:h._v=(M.DecodeUnion(void 0,"$",[[0,[["$0","Item",M.Id(),0]]]]))();};}(self));
