(function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;b=a.WebSharper=a.WebSharper||{};c=b.Client=b.Client||{};d=a.TwitterClone_Templates=a.TwitterClone_Templates||{};e=b&&b.Strings;f=a.IntelliFactory;g=f&&f.Runtime;h=b&&b.Utils;i=a.console;j=b&&b.Concurrency;k=b&&b.Remoting;l=k&&k.AjaxRemotingProvider;m=b&&b.UI;n=m&&m.Var$1;o=m&&m.Templating;p=o&&o.Runtime;q=p&&p.Server;r=q&&q.ProviderBuilder;s=q&&q.Handler;t=q&&q.TemplateInstance;u=a.JSON;v=m&&m.Doc;w=m&&m.AttrProxy;x=m&&m.Client;y=x&&x.Templates;c.Twitter$143$21=function(z){return function(A){var B,C,D,E,F;B=A.Vars.Hole("tweetcontent").$1.Get();C="\""+e.Join("\",\"",e.SplitChars(A.Vars.Hole("tweettags").$1.Get(),[","],0))+"\"";D="\""+e.Join("\",\"",e.SplitChars(A.Vars.Hole("tweetmentions").$1.Get(),[","],0))+"\"";E=((((g.Curried(function(G,H,I,J){return G("{\"content\": \""+h.toSafe(H)+"\", \"tag\": ["+h.toSafe(I)+"], \"mention\": ["+h.toSafe(J)+"]}");},4))(a.id))(B))(C))(D);i.log(E);j.StartImmediate((F=null,j.Delay(function(){return j.Bind((new l.New()).Async("TwitterClone:WebSharper.Server.DoTweet:-70456950",[E]),function(G){z.Set(G);return j.Zero();});})),null);};};c.Twitter=function(){var z,A,B,C,D,E,F;z=n.Create$1("");return(A=(B=z.get_View(),(C=(D=new r.New$1(),(D.h.push(s.EventQ2(D.k,"ontweet",function(){return D.i;},function(G){var H,I,J,K,L;H=G.Vars.Hole("tweetcontent").$1.Get();I="\""+e.Join("\",\"",e.SplitChars(G.Vars.Hole("tweettags").$1.Get(),[","],0))+"\"";J="\""+e.Join("\",\"",e.SplitChars(G.Vars.Hole("tweetmentions").$1.Get(),[","],0))+"\"";K=((((g.Curried(function(M,N,O,P){return M("{\"content\": \""+h.toSafe(N)+"\", \"tag\": ["+h.toSafe(O)+"], \"mention\": ["+h.toSafe(P)+"]}");},4))(a.id))(H))(I))(J);i.log(K);j.StartImmediate((L=null,j.Delay(function(){return j.Bind((new l.New()).Async("TwitterClone:WebSharper.Server.DoTweet:-70456950",[K]),function(M){z.Set(M);return j.Zero();});})),null);})),D)),(C.h.push({$:2,$0:"result",$1:B}),C))),(E=s.CompleteHoles(A.k,A.h,[["tweetcontent",0],["tweettags",0],["tweetmentions",0],["tweetid",0],["retweettags",0],["retweetmentions",0]]),(F=new t.New(E[1],d.twitterform(E[0])),A.i=F,F))).get_Doc();};c.Register$123$24=function(){return function(z){var A,B,C,D,E;A=z.Vars.Hole("registerusername").$1.Get();B=z.Vars.Hole("registeruserpass").$1.Get();C=z.Vars.Hole("registeruseremail").$1.Get();D=(((g.Curried3(function(F,G,H){return F("{\"email\": \""+h.toSafe(G)+"\", \"nickName\": \""+h.toSafe(H)+"\"}");}))(a.id))(C))(A);i.log(A+" : "+B+" : "+C);j.StartImmediate((E=null,j.Delay(function(){return j.Bind((new l.New()).Async("TwitterClone:WebSharper.Server.DoRegister:-877319491",[A,B,D]),function(F){return u.parse(F).status==="success"?(self.location.replace("/"),j.Zero()):j.Zero();});})),null);};};c.Register=function(){var z,A,B,C;n.Create$1("");return(z=(A=new r.New$1(),(A.h.push(s.EventQ2(A.k,"onregister",function(){return A.i;},function(D){var E,F,G,H,I;E=D.Vars.Hole("registerusername").$1.Get();F=D.Vars.Hole("registeruserpass").$1.Get();G=D.Vars.Hole("registeruseremail").$1.Get();H=(((g.Curried3(function(J,K,L){return J("{\"email\": \""+h.toSafe(K)+"\", \"nickName\": \""+h.toSafe(L)+"\"}");}))(a.id))(G))(E);i.log(E+" : "+F+" : "+G);j.StartImmediate((I=null,j.Delay(function(){return j.Bind((new l.New()).Async("TwitterClone:WebSharper.Server.DoRegister:-877319491",[E,F,H]),function(J){return u.parse(J).status==="success"?(self.location.replace("/"),j.Zero()):j.Zero();});})),null);})),A)),(B=s.CompleteHoles(z.k,z.h,[["registerusername",0],["registeruseremail",0],["registeruserpass",0]]),(C=new t.New(B[1],d.loginblock(B[0])),z.i=C,C))).get_Doc();};c.Login$104$21=function(){return function(z){var A,B,C;A=z.Vars.Hole("inputusername").$1.Get();B=z.Vars.Hole("inputuserpass").$1.Get();i.log(A+" : "+B);j.StartImmediate((C=null,j.Delay(function(){return j.Bind((new l.New()).Async("TwitterClone:WebSharper.Server.DoLogin:1487421784",[A,B]),function(D){return u.parse(D).status==="success"?(self.location.replace("/"),j.Zero()):j.Zero();});})),null);};};c.Login=function(){var z,A,B,C;return(z=(A=new r.New$1(),(A.h.push(s.EventQ2(A.k,"onlogin",function(){return A.i;},function(D){var E,F,G;E=D.Vars.Hole("inputusername").$1.Get();F=D.Vars.Hole("inputuserpass").$1.Get();i.log(E+" : "+F);j.StartImmediate((G=null,j.Delay(function(){return j.Bind((new l.New()).Async("TwitterClone:WebSharper.Server.DoLogin:1487421784",[E,F]),function(H){return u.parse(H).status==="success"?(self.location.replace("/"),j.Zero()):j.Zero();});})),null);})),A)),(B=s.CompleteHoles(z.k,z.h,[["inputusername",0],["inputuserpass",0]]),(C=new t.New(B[1],d.loginblock$1(B[0])),z.i=C,C))).get_Doc();};c.Test=function(){var z,A;z=v.Input([],n.Create$1(""));A=v.Element("div",[w.Create("class","panel-default")],[v.Element("div",[w.Create("class","panel-body")],[z])]);y.LoadLocalTemplates("");v.RunById("main",A);};c.Db$70$22=function(){return function(){var z;j.StartImmediate((z=null,j.Delay(function(){(new l.New()).Send("TwitterClone:WebSharper.Server.DoDBInit:6",[]);return j.Zero();})),null);};};c.Db=function(){var z,A,B,C,D;return(z=(A=(B=new r.New$1(),(B.h.push(s.EventQ2(B.k,"oninitdb",function(){return B.i;},function(){var E;j.StartImmediate((E=null,j.Delay(function(){(new l.New()).Send("TwitterClone:WebSharper.Server.DoDBInit:6",[]);return j.Zero();})),null);})),B)),(A.h.push({$:1,$0:"result",$1:"Sccess!"}),A)),(C=s.CompleteHoles(z.k,z.h,[["texttoreverse",0]]),(D=new t.New(C[1],d.mainform(C[0])),z.i=D,D))).get_Doc();};c.guest$38$26=g.Curried3(function(z,A,B){var C;return j.Start((C=null,j.Delay(function(){i.log("login");self.location.replace("/welcome");return j.Return(null);})),null);});c.guest=function(){return v.Element("div",[w.Create("style","margin-bottom: 20px")],[v.Element("p",[w.Create("style","display: inline; margin: 0 10px 15px 0")],[v.TextNode("click here to log in:")]),v.Element("button",[w.Create("class","btn btn-primary mybtn"),w.HandlerImpl("click",function(){return function(){var z;return j.Start((z=null,j.Delay(function(){i.log("login");self.location.replace("/welcome");return j.Return(null);})),null);};})],[v.TextNode("login")])]);};c.LoggedInUser$23$26=g.Curried3(function(z,A,B){var C;return j.Start((C=null,j.Delay(function(){return j.Bind((new l.New()).Async("TwitterClone:WebSharper.Server.DoLogout:155708957",[]),function(){self.location.replace("/");return j.Return(null);});})),null);});c.LoggedInUser=function(){return v.Element("div",[w.Create("style","margin-bottom: 20px")],[v.Element("p",[w.Create("style","display: inline; margin: 0 10px 15px 0")],[v.TextNode("click here to log out:")]),v.Element("button",[w.Create("class","btn btn-primary mybtn"),w.HandlerImpl("click",function(){return function(){var z;return j.Start((z=null,j.Delay(function(){return j.Bind((new l.New()).Async("TwitterClone:WebSharper.Server.DoLogout:155708957",[]),function(){self.location.replace("/");return j.Return(null);});})),null);};})],[v.TextNode("logout")])]);};d.twitterform=function(z){y.LoadLocalTemplates("twitter");return z?y.NamedTemplate("twitter",{$:1,$0:"twitterform"},z):void 0;};d.loginblock=function(z){y.LoadLocalTemplates("register");return z?y.NamedTemplate("register",{$:1,$0:"loginblock"},z):void 0;};d.loginblock$1=function(z){y.LoadLocalTemplates("login");return z?y.NamedTemplate("login",{$:1,$0:"loginblock"},z):void 0;};d.mainform=function(z){y.LoadLocalTemplates("main");return z?y.NamedTemplate("main",{$:1,$0:"mainform"},z):void 0;};}(self));
